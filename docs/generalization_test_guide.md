# æ³›åŒ–èƒ½åŠ›æµ‹è¯•æŒ‡å—

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•æµ‹è¯•AdaBoostæ¨¡å‹å¯¹è§†è§‰æ‰°åŠ¨çš„é²æ£’æ€§ã€‚

## æµ‹è¯•åŸç†

### ä»€ä¹ˆæ˜¯æ³›åŒ–èƒ½åŠ›ï¼Ÿ

**æ³›åŒ–èƒ½åŠ›**æ˜¯æŒ‡æ¨¡å‹åœ¨**æœªè§è¿‡çš„æ•°æ®**ä¸Šçš„è¡¨ç°èƒ½åŠ›ã€‚

### ä¸ºä»€ä¹ˆè¦æµ‹è¯•è§†è§‰æ‰°åŠ¨ï¼Ÿ

åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¾“å…¥æ•°æ®å¯èƒ½å­˜åœ¨ï¼š
- ğŸŒ“ **äº®åº¦å˜åŒ–**ï¼šä¸åŒå…‰ç…§æ¡ä»¶
- ğŸŒ«ï¸ **å™ªå£°**ï¼šä¼ æ„Ÿå™¨å™ªå£°ã€å‹ç¼©å™ªå£°
- ğŸ”² **æ¨¡ç³Š**ï¼šå¤±ç„¦ã€è¿åŠ¨æ¨¡ç³Š
- ğŸ“ **å‡ ä½•å˜æ¢**ï¼šè½»å¾®æ—‹è½¬ã€å¹³ç§»
- ğŸ¨ **å¯¹æ¯”åº¦**ï¼šæ˜¾ç¤ºè®¾å¤‡å·®å¼‚

**å¥½çš„æ¨¡å‹åº”è¯¥å¯¹è¿™äº›æ‰°åŠ¨å…·æœ‰é²æ£’æ€§ã€‚**

---

## æµ‹è¯•æ–¹æ¡ˆ

### æµ‹è¯•æµç¨‹

```
1. åœ¨æ ‡å‡†MNISTä¸Šè®­ç»ƒæ¨¡å‹
   â†“
2. ç”Ÿæˆå¸¦æ‰°åŠ¨çš„æµ‹è¯•é›†
   â†“
3. åœ¨æ‰°åŠ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°
   â†“
4. å¯¹æ¯”åˆ†ææ€§èƒ½ä¸‹é™
```

### æ‰°åŠ¨ç±»å‹

æˆ‘ä»¬å®ç°äº†7ç§æ‰°åŠ¨ï¼š

#### 1. äº®åº¦åç§» ğŸŒ“

**æ•ˆæœï¼š** æ•´ä½“å˜äº®æˆ–å˜æš—

**å‚æ•°ï¼š** `shift_range` - åç§»èŒƒå›´

```python
# äº®åº¦ Â± 30%
X_perturbed = X + shift  # shift âˆˆ [-0.3, 0.3]
```

**æ¨¡æ‹Ÿåœºæ™¯ï¼š**
- ä¸åŒå…‰ç…§æ¡ä»¶
- æ›å…‰å·®å¼‚
- æ‰«æä»ªè®¾ç½®ä¸åŒ

#### 2. é«˜æ–¯å™ªå£° ğŸ“¡

**æ•ˆæœï¼š** æ·»åŠ éšæœºå™ªå£°

**å‚æ•°ï¼š** `noise_std` - å™ªå£°æ ‡å‡†å·®

```python
# é«˜æ–¯å™ªå£° Ïƒ=0.1
X_perturbed = X + N(0, 0.1Â²)
```

**æ¨¡æ‹Ÿåœºæ™¯ï¼š**
- ä¼ æ„Ÿå™¨å™ªå£°
- æ•°å­—åŒ–å™ªå£°
- é€šä¿¡å¹²æ‰°

#### 3. æ¤’ç›å™ªå£° âš«âšª

**æ•ˆæœï¼š** éšæœºé»‘ç‚¹å’Œç™½ç‚¹

**å‚æ•°ï¼š** `amount` - å™ªå£°æ¯”ä¾‹

```python
# 5% æ¤’ç›å™ªå£°
# 2.5% åƒç´ å˜ä¸ºé»‘è‰²
# 2.5% åƒç´ å˜ä¸ºç™½è‰²
```

**æ¨¡æ‹Ÿåœºæ™¯ï¼š**
- å›¾åƒé‡‡é›†é”™è¯¯
- ä¼ è¾“é”™è¯¯
- æŸåçš„åƒç´ 

#### 4. æ¨¡ç³Š ğŸŒ«ï¸

**æ•ˆæœï¼š** è¾¹ç¼˜æ¨¡ç³Š

**å‚æ•°ï¼š** `kernel_size` - æ¨¡ç³Šæ ¸å¤§å°

```python
# 3x3 å¹³å‡æ»¤æ³¢
X_perturbed = uniform_filter(X, size=3)
```

**æ¨¡æ‹Ÿåœºæ™¯ï¼š**
- å¤±ç„¦
- è¿åŠ¨æ¨¡ç³Š
- ä½åˆ†è¾¨ç‡

#### 5. å¯¹æ¯”åº¦è°ƒæ•´ ğŸ¨

**æ•ˆæœï¼š** å¢å¼ºæˆ–å‡å¼±å¯¹æ¯”åº¦

**å‚æ•°ï¼š** `factor_range` - å¯¹æ¯”åº¦å› å­èŒƒå›´

```python
# å¯¹æ¯”åº¦ Â± 50%
X_perturbed = mean + factor * (X - mean)
# factor âˆˆ [0.5, 1.5]
```

**æ¨¡æ‹Ÿåœºæ™¯ï¼š**
- æ˜¾ç¤ºè®¾å¤‡å·®å¼‚
- å›¾åƒå¤„ç†å·®å¼‚
- æ‰«æè´¨é‡

#### 6. æ—‹è½¬ ğŸ”„

**æ•ˆæœï¼š** è½»å¾®æ—‹è½¬

**å‚æ•°ï¼š** `angle_range` - æ—‹è½¬è§’åº¦èŒƒå›´ï¼ˆåº¦ï¼‰

```python
# æ—‹è½¬ Â± 15Â°
X_perturbed = rotate(X, angle)
# angle âˆˆ [-15Â°, 15Â°]
```

**æ¨¡æ‹Ÿåœºæ™¯ï¼š**
- æ‰‹å†™å€¾æ–œ
- æ‹ç…§è§’åº¦
- æ‰«ææœªå¯¹é½

---

## ä½¿ç”¨æ–¹æ³•

### å¿«é€Ÿå¼€å§‹

```bash
python test_generalization.py
```

**è¿è¡Œæ—¶é—´ï¼š** çº¦10-15åˆ†é’Ÿ

**è¾“å‡ºï¼š**
1. `results/perturbation_examples.png` - æ‰°åŠ¨ç¤ºä¾‹å±•ç¤º
2. `results/generalization_test.png` - æ³›åŒ–æµ‹è¯•ç»“æœ
3. æ§åˆ¶å°è¯¦ç»†æŠ¥å‘Š

### æµ‹è¯•æµç¨‹

```
æ­¥éª¤1: å‡†å¤‡æ•°æ®
æ­¥éª¤2: åˆ›å»ºæ•°æ®æ‰°åŠ¨å™¨
æ­¥éª¤3: è®­ç»ƒæ¨¡å‹
  - æ ‡å‡†AdaBoost
  - é²æ£’AdaBoost
æ­¥éª¤4: æµ‹è¯•æ³›åŒ–èƒ½åŠ›ï¼ˆ17ç§æ‰°åŠ¨é…ç½®ï¼‰
æ­¥éª¤5: ç”Ÿæˆå¯è§†åŒ–
æ­¥éª¤6: æ‰“å°æ€»ç»“æŠ¥å‘Š
```

---

## ç»“æœè§£è¯»

### è¾“å‡ºç¤ºä¾‹

```
æ ‡å‡†AdaBoost:
  åŸºçº¿å‡†ç¡®ç‡ï¼ˆæ— æ‰°åŠ¨ï¼‰: 0.8200 (82.00%)
  å¹³å‡å‡†ç¡®ç‡ï¼ˆæœ‰æ‰°åŠ¨ï¼‰: 0.7450 (74.50%)
  å¹³å‡å‡†ç¡®ç‡ä¸‹é™: 0.0750 (7.50%)
  æœ€å¤§å‡†ç¡®ç‡ä¸‹é™: 0.1500 (15.00%)
  æœ€éš¾æ‰°åŠ¨: æ—‹è½¬Â±15Â° (å‡†ç¡®ç‡: 0.6700)

é²æ£’AdaBoost:
  åŸºçº¿å‡†ç¡®ç‡ï¼ˆæ— æ‰°åŠ¨ï¼‰: 0.8100 (81.00%)
  å¹³å‡å‡†ç¡®ç‡ï¼ˆæœ‰æ‰°åŠ¨ï¼‰: 0.7600 (76.00%)
  å¹³å‡å‡†ç¡®ç‡ä¸‹é™: 0.0500 (5.00%)
  æœ€å¤§å‡†ç¡®ç‡ä¸‹é™: 0.1000 (10.00%)
  æœ€éš¾æ‰°åŠ¨: æ—‹è½¬Â±15Â° (å‡†ç¡®ç‡: 0.7100)
```

### å…³é”®æŒ‡æ ‡

#### 1. åŸºçº¿å‡†ç¡®ç‡

**å®šä¹‰ï¼š** åœ¨æ— æ‰°åŠ¨æµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡

**æ„ä¹‰ï¼š** æ¨¡å‹çš„åŸºæœ¬æ€§èƒ½

#### 2. å¹³å‡å‡†ç¡®ç‡ï¼ˆæœ‰æ‰°åŠ¨ï¼‰

**å®šä¹‰ï¼š** åœ¨æ‰€æœ‰æ‰°åŠ¨æµ‹è¯•é›†ä¸Šçš„å¹³å‡å‡†ç¡®ç‡

**æ„ä¹‰ï¼š** æ•´ä½“æ³›åŒ–èƒ½åŠ›

**è¯„ä»·æ ‡å‡†ï¼š**
- > åŸºçº¿-5%ï¼šâœ… ä¼˜ç§€
- åŸºçº¿-5%è‡³-10%ï¼šâœ… è‰¯å¥½
- åŸºçº¿-10%è‡³-15%ï¼šâš ï¸ ä¸€èˆ¬
- < åŸºçº¿-15%ï¼šâŒ è¾ƒå·®

#### 3. å¹³å‡å‡†ç¡®ç‡ä¸‹é™

**å®šä¹‰ï¼š** åŸºçº¿å‡†ç¡®ç‡ - å¹³å‡å‡†ç¡®ç‡

**æ„ä¹‰ï¼š** å¯¹æ‰°åŠ¨çš„å¹³å‡æ•æ„Ÿåº¦

**è¯„ä»·æ ‡å‡†ï¼š**
- < 5%ï¼šâœ… é²æ£’æ€§ä¼˜ç§€
- 5-10%ï¼šâœ… é²æ£’æ€§è‰¯å¥½
- 10-15%ï¼šâš ï¸ é²æ£’æ€§ä¸€èˆ¬
- > 15%ï¼šâŒ é²æ£’æ€§è¾ƒå·®

#### 4. æœ€å¤§å‡†ç¡®ç‡ä¸‹é™

**å®šä¹‰ï¼š** æ‰€æœ‰æ‰°åŠ¨ä¸­æœ€å¤§çš„å‡†ç¡®ç‡ä¸‹é™

**æ„ä¹‰ï¼š** æœ€è„†å¼±çš„æƒ…å†µ

**ç”¨é€”ï¼š** å‘ç°æ¨¡å‹çš„å¼±ç‚¹

#### 5. æœ€éš¾æ‰°åŠ¨

**å®šä¹‰ï¼š** å‡†ç¡®ç‡ä¸‹é™æœ€å¤šçš„æ‰°åŠ¨ç±»å‹

**æ„ä¹‰ï¼š** éœ€è¦é‡ç‚¹æ”¹è¿›çš„æ–¹å‘

---

## å¯è§†åŒ–è¯´æ˜

### å›¾1ï¼šæ‰°åŠ¨ç¤ºä¾‹å±•ç¤º

**å†…å®¹ï¼š** 7ç§æ‰°åŠ¨ç±»å‹ Ã— 5ä¸ªæ ·æœ¬

**ç”¨é€”ï¼š** 
- ç›´è§‚ç†è§£æ¯ç§æ‰°åŠ¨çš„æ•ˆæœ
- éªŒè¯æ‰°åŠ¨å¼ºåº¦æ˜¯å¦åˆé€‚

### å›¾2ï¼šæ³›åŒ–æµ‹è¯•ç»“æœ

åŒ…å«ä¸¤ä¸ªå­å›¾ï¼š

#### å­å›¾1ï¼šä¸åŒæ‰°åŠ¨ä¸‹çš„å‡†ç¡®ç‡

**æ¨ªè½´ï¼š** æ‰°åŠ¨ç±»å‹ï¼ˆ17ç§é…ç½®ï¼‰  
**çºµè½´ï¼š** å‡†ç¡®ç‡

**è§£è¯»ï¼š**
- æŸ±å­è¶Šé«˜è¶Šå¥½
- å¯¹æ¯”ä¸åŒæ¨¡å‹çš„æŸ±å­é«˜åº¦
- æ‰¾å‡ºå“ªäº›æ‰°åŠ¨å¯¼è‡´æ€§èƒ½ä¸‹é™æœ€å¤š

#### å­å›¾2ï¼šå‡†ç¡®ç‡ä¸‹é™å¹…åº¦

**æ¨ªè½´ï¼š** æ‰°åŠ¨ç±»å‹  
**çºµè½´ï¼š** å‡†ç¡®ç‡ä¸‹é™

**é¢œè‰²ï¼š**
- ğŸŸ¢ ç»¿è‰²ï¼šè´Ÿå€¼ï¼ˆæ€§èƒ½æå‡ï¼Œç½•è§ï¼‰
- ğŸ”´ çº¢è‰²ï¼šæ­£å€¼ï¼ˆæ€§èƒ½ä¸‹é™ï¼Œå¸¸è§ï¼‰

**è§£è¯»ï¼š**
- æŸ±å­è¶Šä½ï¼ˆæ¥è¿‘0ï¼‰è¶Šå¥½
- çº¢è‰²åŒºåŸŸè¶Šå°è¶Šå¥½
- å¯¹æ¯”ä¸åŒæ¨¡å‹çš„é²æ£’æ€§

---

## å…¸å‹ç»“æœåˆ†æ

### åœºæ™¯1ï¼šæ ‡å‡†MNISTæ•°æ®

**é¢„æœŸç»“æœï¼š**
```
åŸºçº¿å‡†ç¡®ç‡: 75-85%
å¹³å‡ä¸‹é™: 5-10%
æœ€éš¾æ‰°åŠ¨: æ—‹è½¬Â±15Â°
```

**åŸå› ï¼š**
- MNISTè®­ç»ƒæ•°æ®å·²ç»æ˜¯æ ‡å‡†åŒ–çš„
- å¯¹ç®€å•æ‰°åŠ¨ï¼ˆäº®åº¦ã€å™ªå£°ï¼‰æœ‰ä¸€å®šæŠ—æ€§
- å¯¹å‡ ä½•å˜æ¢ï¼ˆæ—‹è½¬ï¼‰è¾ƒæ•æ„Ÿ

### åœºæ™¯2ï¼šå¯¹æ¯”æ ‡å‡†vsé²æ£’AdaBoost

**é¢„æœŸå·®å¼‚ï¼š**

| æŒ‡æ ‡ | æ ‡å‡†AdaBoost | é²æ£’AdaBoost | æ”¹è¿› |
|------|-------------|-------------|------|
| åŸºçº¿å‡†ç¡®ç‡ | 82% | 81% | -1% |
| å¹³å‡å‡†ç¡®ç‡ | 75% | 77% | +2% |
| å¹³å‡ä¸‹é™ | 7% | 4% | -3% |

**ç»“è®ºï¼š**
- é²æ£’æ–¹æ³•å¯èƒ½ç‰ºç‰²1-2%åŸºçº¿æ€§èƒ½
- ä½†åœ¨æ‰°åŠ¨æ•°æ®ä¸Šè¡¨ç°æ›´å¥½
- æ•´ä½“é²æ£’æ€§æå‡30-40%

---

## æ”¹è¿›å»ºè®®

### å¦‚æœæ³›åŒ–èƒ½åŠ›å·®ï¼š

#### 1. æ•°æ®å¢å¼º

```python
# è®­ç»ƒæ—¶æ·»åŠ æ‰°åŠ¨
from sklearn.utils import shuffle

X_train_augmented = []
y_train_augmented = []

for X_batch, y_batch in batches:
    # åŸå§‹æ•°æ®
    X_train_augmented.append(X_batch)
    y_train_augmented.append(y_batch)
    
    # æ·»åŠ æ‰°åŠ¨ç‰ˆæœ¬
    X_perturbed = perturber.add_gaussian_noise(X_batch, noise_std=0.05)
    X_train_augmented.append(X_perturbed)
    y_train_augmented.append(y_batch)

# åˆå¹¶å¹¶è®­ç»ƒ
X_train_aug = np.vstack(X_train_augmented)
y_train_aug = np.hstack(y_train_augmented)
clf.fit(X_train_aug, y_train_aug)
```

#### 2. ä½¿ç”¨é²æ£’æ–¹æ³•

```python
from src.robust_adaboost import create_robust_adaboost

# ä½¿ç”¨é²æ£’AdaBoost
clf = create_robust_adaboost(strategy="balanced")
```

#### 3. æ­£åˆ™åŒ–

```python
# ä½¿ç”¨æ›´ä¿å®ˆçš„é…ç½®
clf = AdaBoostClassifier(
    n_estimators=30,        # å‡å°‘å¼±å­¦ä¹ å™¨
    learning_rate=0.3,      # é™ä½å­¦ä¹ ç‡
    base_estimator=DecisionTreeClassifier(max_depth=1)  # ç®€å•åŸºå­¦ä¹ å™¨
)
```

#### 4. é›†æˆæ–¹æ³•

```python
from sklearn.ensemble import VotingClassifier

# å¤šæ¨¡å‹æŠ•ç¥¨
clf = VotingClassifier([
    ('adaboost', clf_adaboost),
    ('rf', clf_random_forest),
    ('svm', clf_svm),
], voting='soft')
```

---

## æ‰©å±•æµ‹è¯•

### è‡ªå®šä¹‰æ‰°åŠ¨

```python
from test_generalization import MNISTPerturber

perturber = MNISTPerturber()

# è‡ªå®šä¹‰æ‰°åŠ¨
def my_perturbation(X):
    # ä½ çš„æ‰°åŠ¨é€»è¾‘
    return X_perturbed

# æµ‹è¯•
X_test_perturbed = my_perturbation(X_test)
acc = clf.score(X_test_perturbed, y_test)
```

### ç»„åˆæ‰°åŠ¨

```python
# åŒæ—¶åº”ç”¨å¤šç§æ‰°åŠ¨
X_perturbed = X_test
X_perturbed = perturber.add_gaussian_noise(X_perturbed, noise_std=0.05)
X_perturbed = perturber.add_brightness_shift(X_perturbed, shift_range=0.1)
X_perturbed = perturber.add_blur(X_perturbed, kernel_size=3)

# æµ‹è¯•
acc = clf.score(X_perturbed, y_test)
print(f"ç»„åˆæ‰°åŠ¨å‡†ç¡®ç‡: {acc:.4f}")
```

### é€æ­¥å¢å¼ºæ‰°åŠ¨

```python
import matplotlib.pyplot as plt

# æµ‹è¯•ä¸åŒå¼ºåº¦
noise_levels = [0, 0.05, 0.10, 0.15, 0.20, 0.25]
accuracies = []

for noise_std in noise_levels:
    X_perturbed = perturber.add_gaussian_noise(X_test, noise_std=noise_std)
    acc = clf.score(X_perturbed, y_test)
    accuracies.append(acc)

# ç»˜åˆ¶
plt.plot(noise_levels, accuracies, 'o-')
plt.xlabel('å™ªå£°æ ‡å‡†å·®')
plt.ylabel('å‡†ç¡®ç‡')
plt.title('å‡†ç¡®ç‡ vs å™ªå£°å¼ºåº¦')
plt.grid(True)
plt.show()
```

---

## å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆæŸäº›æ‰°åŠ¨å‡†ç¡®ç‡åè€Œæå‡ï¼Ÿ

**A:** å¯èƒ½çš„åŸå› ï¼š
1. æ‰°åŠ¨èµ·åˆ°äº†"æ­£åˆ™åŒ–"ä½œç”¨
2. å»é™¤äº†è¿‡æ‹Ÿåˆçš„ç»†èŠ‚
3. ç»Ÿè®¡æ³¢åŠ¨ï¼ˆæ ·æœ¬é‡ä¸å¤Ÿï¼‰

### Q2: å¦‚ä½•é€‰æ‹©æ‰°åŠ¨å¼ºåº¦ï¼Ÿ

**A:** å»ºè®®ï¼š
- ä»å®é™…åº”ç”¨åœºæ™¯å‡ºå‘
- å‚è€ƒç°æœ‰ç ”ç©¶
- é€æ­¥å¢å¼ºæµ‹è¯•

### Q3: æ³›åŒ–æµ‹è¯•éœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿ

**A:** 
- å®Œæ•´æµ‹è¯•ï¼ˆ17ç§æ‰°åŠ¨ï¼‰ï¼šçº¦10-15åˆ†é’Ÿ
- å¯ä»¥å‡å°‘æµ‹è¯•é…ç½®åŠ å¿«é€Ÿåº¦

### Q4: å¦‚ä½•æå‡æ³›åŒ–èƒ½åŠ›ï¼Ÿ

**A:** ä¼˜å…ˆçº§ï¼š
1. æ•°æ®å¢å¼ºï¼ˆæœ€æœ‰æ•ˆï¼‰
2. ä½¿ç”¨é²æ£’æ–¹æ³•
3. æ­£åˆ™åŒ–
4. é›†æˆæ–¹æ³•

### Q5: æµ‹è¯•ç»“æœå¦‚ä½•ç”¨äºè®ºæ–‡ï¼Ÿ

**A:** å¯ä»¥ï¼š
1. å±•ç¤ºæ‰°åŠ¨ç¤ºä¾‹å›¾
2. ç»˜åˆ¶å‡†ç¡®ç‡æ›²çº¿
3. åˆ¶ä½œå¯¹æ¯”è¡¨æ ¼
4. åˆ†æé²æ£’æ€§æ”¹è¿›

---

## å‚è€ƒèµ„æ–™

1. **æ•°æ®å¢å¼º**: https://arxiv.org/abs/1712.04621
2. **å¯¹æŠ—é²æ£’æ€§**: https://arxiv.org/abs/1706.06083
3. **æµ‹è¯•é›†æ‰°åŠ¨**: https://arxiv.org/abs/1903.12261

---

**æœ€åæ›´æ–°ï¼š** 2024å¹´  
**ç»´æŠ¤è€…ï¼š** MLé¡¹ç›®ç»„

